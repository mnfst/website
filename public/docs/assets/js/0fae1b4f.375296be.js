"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[16],{8004:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>u,frontMatter:()=>c,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"crud","title":"CRUD Operations","description":"Introduction","source":"@site/content/crud.md","sourceDirName":".","slug":"/crud","permalink":"/docs/crud","draft":false,"unlisted":false,"editUrl":"https://github.com/mnfst/docs/blob/master/crud.md","tags":[],"version":"current","frontMatter":{"id":"crud"},"sidebar":"docSidebar","previous":{"title":"Entities","permalink":"/docs/entities"},"next":{"title":"Validation","permalink":"/docs/validation"}}');var i=t(4848),l=t(8453),a=t(5537),r=t(9329);const c={id:"crud"},d="CRUD Operations",o={},h=[{value:"Introduction",id:"introduction",level:2},{value:"Using the REST API",id:"using-the-rest-api",level:2},{value:"Using the JavaScript SDK",id:"using-the-javascript-sdk",level:2},{value:"Collections",id:"collections",level:2},{value:"Get a list of items",id:"get-a-list-of-items",level:3},{value:"Get a single item",id:"get-a-single-item",level:3},{value:"Create a new item",id:"create-a-new-item",level:3},{value:"Update an item",id:"update-an-item",level:3},{value:"Patch an item",id:"patch-an-item",level:3},{value:"Delete an item",id:"delete-an-item",level:3},{value:"Singles",id:"singles",level:2},{value:"Get a single item",id:"get-a-single-item-1",level:3},{value:"Update an item",id:"update-an-item-1",level:3},{value:"Patch an item",id:"patch-an-item-1",level:3},{value:"Work with relations",id:"work-with-relations",level:2},{value:"Load relations",id:"load-relations",level:3},{value:"Filter by relation",id:"filter-by-relation",level:3},{value:"Store relations",id:"store-relations",level:3},{value:"Update relations",id:"update-relations",level:3}];function p(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"crud-operations",children:"CRUD Operations"})}),"\n",(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsxs)(n.p,{children:["Once you created your ",(0,i.jsx)(n.a,{href:"/docs/entities",children:"entities"}),", you probably want to interact with them. It is easy to connect your client to your Manifest backend."]}),"\n",(0,i.jsxs)(n.p,{children:["Manifest provides out-of-the-box CRUD endpoints through the ",(0,i.jsx)(n.strong,{children:"REST API"})," or the ",(0,i.jsx)(n.strong,{children:"JS SDK"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["CRUD operations can be restricted using ",(0,i.jsx)(n.a,{href:"/docs/authentication#access-policies",children:"access policies"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"using-the-rest-api",children:"Using the REST API"}),"\n",(0,i.jsxs)(n.p,{children:["Manifest exposes a REST API for CRUD operations. The ",(0,i.jsx)(n.strong,{children:"OpenAPI"})," documentation is automatically generated on ",(0,i.jsx)(n.a,{href:"http://localhost:1111/api",children:"http://localhost:1111/api"}),". Have a look!"]}),"\n",(0,i.jsxs)(n.p,{children:["For CRUD endpoints, this prefix is followed by ",(0,i.jsx)(n.code,{children:"collections"})," for ",(0,i.jsx)(n.a,{href:"#collections",children:"collections entities"})," and ",(0,i.jsx)(n.code,{children:"singles"})," for ",(0,i.jsx)(n.a,{href:"#singles",children:"single entities"})," and by the slug of your entity (you can change it in the ",(0,i.jsx)(n.a,{href:"/docs/entities#entity-params",children:"entity params"}),")"]}),"\n",(0,i.jsx)(n.p,{children:"Examples:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"http://localhost:1111/api/collections/cats"})," gets the list of the cats"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"http://localhost:1111/api/singles/home-content"})," gets the home content"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["In addition to ",(0,i.jsx)(n.strong,{children:"CRUD endpoints"})," that are generated automatically, you also can create your own ",(0,i.jsx)(n.a,{href:"/docs/endpoints",children:"custom endpoints"})," to add your custom logic."]})}),"\n",(0,i.jsx)(n.h2,{id:"using-the-javascript-sdk",children:"Using the JavaScript SDK"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"Manifest JS SDK"})," is used to fetch and manipulate your data from your JS client using an elegant and human-friendly interface."]}),"\n",(0,i.jsxs)(n.p,{children:["The SDK can be integrated in any frontend stack app like ",(0,i.jsx)(n.a,{href:"/docs/react",children:"React"}),", ",(0,i.jsx)(n.a,{href:"/docs/vue",children:"Vue"}),", ",(0,i.jsx)(n.a,{href:"/docs/svelte",children:"Svelte"}),".... Or even by another server using NodeJS!"]}),"\n",(0,i.jsx)(n.p,{children:"Install it via the terminal:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm i @mnfst/sdk\n"})}),"\n",(0,i.jsx)(n.p,{children:"Use the SDK directly in your favorite frontend:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="Example SDK usage"',children:"import Manifest from '@mnfst/sdk'\n\n// Initialize client with default backend URL: http://localhost:1111.\nconst manifest = new Manifest()\n\n// Initialize client with custom base URL.\nconst manifest = new Manifest('https://example.com')\n\n// Perform CRUD operations...\nconst cats = await manifest.from('cats').find()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"collections",children:"Collections"}),"\n",(0,i.jsxs)(n.p,{children:["The following CRUD operations can be done on ",(0,i.jsx)(n.a,{href:"/docs/entities#collections",children:"collections"})," entities. A collection is a list of items that share a similar schema."]}),"\n",(0,i.jsx)(n.h3,{id:"get-a-list-of-items",children:"Get a list of items"}),"\n",(0,i.jsx)(n.p,{children:"This operation will fetch a list of items from a collection."}),"\n",(0,i.jsxs)(a.A,{children:[(0,i.jsxs)(r.A,{value:"rest",label:"REST API",default:!0,children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request URL"}),": ",(0,i.jsx)(n.code,{children:"GET /api/collections/:slug"})]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",metastring:'title="Example HTTP Request"',children:"GET /api/collection/users\n"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="Example HTTP Response"',children:'{\n  "data": [\n    {\n      "id": 1,\n      "name": "Lara"\n    },\n    {\n      "id": 2,\n      "name": "Karl"\n    }\n  ],\n  "currentPage": 1,\n  "lastPage": 1,\n  "from": 1,\n  "to": 10,\n  "total": 3,\n  "perPage": 10\n}\n'})}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"List filters"})}),(0,i.jsxs)(n.p,{children:["You can filter by ",(0,i.jsx)(n.a,{href:"/docs/entities#properties",children:"property"})," to refine the list of items. Use suffix to pass logic to it:"]}),(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Suffix"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Example"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"_eq"})}),(0,i.jsx)(n.td,{children:"equals"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"isActive_eq=true"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"_neq"})}),(0,i.jsx)(n.td,{children:"not equals"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"name_neq=alice"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"_gt"})}),(0,i.jsx)(n.td,{children:"greater than"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"birthdate_gt=2020-01-01 "})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"_gte"})}),(0,i.jsx)(n.td,{children:"greater than or equal"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"age_gte=4"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"_lt"})}),(0,i.jsx)(n.td,{children:"less than"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"amount_lt=400"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"_lte"})}),(0,i.jsx)(n.td,{children:"less than or equal"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"amount_lte=400"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"_like"})}),(0,i.jsx)(n.td,{children:"like"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"name_like=%bi%"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"_in"})}),(0,i.jsx)(n.td,{children:"included in"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"customer_in=1,2,3"})})]})]})]}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Pagination"})}),(0,i.jsxs)(n.p,{children:["All list requests are paginated by default. Just use the ",(0,i.jsx)(n.code,{children:"page"})," parameter to choose your page and the ",(0,i.jsx)(n.code,{children:"perPage"})," param if you want to change the number of items per page."]}),(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Param"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Example"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"page"})}),(0,i.jsx)(n.td,{children:"The number of the page requested"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"page=3"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"perPage"})}),(0,i.jsx)(n.td,{children:"The number of items of each page"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"perPage=40"})})]})]})]}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Order"})}),(0,i.jsxs)(n.p,{children:["Order your list by a defined property. By default the results are ordered by ",(0,i.jsx)(n.code,{children:"id"})," in a ",(0,i.jsx)(n.code,{children:"DESC"})," order and thus shows the new ones first."]}),(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Param"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Example"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"orderBy"})}),(0,i.jsx)(n.td,{children:"The name of property you want to order by."}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"orderBy=age"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"order"})}),(0,i.jsx)(n.td,{children:"Ascending 'ASC' or Descending 'DESC'"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"order=DESC"})})]})]})]})]}),(0,i.jsxs)(r.A,{value:"sdk",label:"JS SDK",default:!0,children:[(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="Example SDK usage"',children:'// Get all users.\nconst users = await manifest.from(\'users\').find()\n\nconsole.log(users);\n// Output: {\n//   "data": [\n//     {\n//       "id": 1,\n//       "name": "Lara"\n//     },\n//     {\n//       "id": 2,\n//       "name": "Karl"\n//     }\n//   ],\n//   "currentPage": 1,\n//   "lastPage": 1,\n//   "from": 1,\n//   "to": 10,\n//   "total": 3,\n//   "perPage": 10\n// }\n'})}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"List filters"})}),(0,i.jsxs)(n.p,{children:["You can filter by ",(0,i.jsx)(n.a,{href:"/docs/entities#properties",children:"property"})," to refine the list of items. Use the ",(0,i.jsx)(n.code,{children:"where()"})," function with the correct operator to do it."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="Example SDK list filtering"',children:"const cats = await manifest\n  .from('cats')\n  .where('breed = siamese')\n  .andWhere('active = true')\n  .andWhere('birthDate > 2020-01-01')\n  .find()\n"})}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Filter operators"})}),(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Operator"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Example"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"="})}),(0,i.jsx)(n.td,{children:"equals"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".where('isActive = true')"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"!="})}),(0,i.jsx)(n.td,{children:"not equals"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".where('name != alice')"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:">"})}),(0,i.jsx)(n.td,{children:"greater than"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".where('birthdate > 2020-01-01')"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:">="})}),(0,i.jsx)(n.td,{children:"greater than or equal"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".where('age >= 4')"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"<"})}),(0,i.jsx)(n.td,{children:"less than"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".where('amount < 400')"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"<="})}),(0,i.jsx)(n.td,{children:"less than or equal"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".where('amount <= 400')"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"like"})}),(0,i.jsx)(n.td,{children:"like"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".where('name_like=%bi%')"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"in"})}),(0,i.jsx)(n.td,{children:"included in"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".where('customer_in=1,2,3')"})})]})]})]}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Pagination"})}),(0,i.jsxs)(n.p,{children:["All list requests are paginated by default. Just use the ",(0,i.jsx)(n.code,{children:"page"})," parameter to chose your page and the ",(0,i.jsx)(n.code,{children:"perPage"})," param if you want to change the number of items per page."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="Example SDK list pagination"',children:"const cats = await manifest.from('cats').find({ page: 1, perPage: 10 })\n"})}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Order"})}),(0,i.jsxs)(n.p,{children:["Order your list by a defined property. By default the results are ordered by ",(0,i.jsx)(n.code,{children:"id"})," in a ",(0,i.jsx)(n.code,{children:"DESC"})," order and thus shows the new ones first."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="Example SDK order"',children:"// Order cats.\nconst cats = await manifest.from('cats').orderBy('age', { desc: true }).find()\n"})})]})]}),"\n",(0,i.jsx)(n.h3,{id:"get-a-single-item",children:"Get a single item"}),"\n",(0,i.jsx)(n.p,{children:"This operation will fetch a single item based on its ID."}),"\n",(0,i.jsxs)(a.A,{children:[(0,i.jsxs)(r.A,{value:"rest",label:"REST API",default:!0,children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request URL"}),": ",(0,i.jsx)(n.code,{children:"GET /api/collections/:slug/:id"})]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",metastring:'title="Example HTTP Request"',children:"GET /api/collections/cats/34\n"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="Example HTTP Response"',children:'{\n  "name": "Mina",\n  "description": "A really cute cat"\n}\n'})})]}),(0,i.jsx)(r.A,{value:"sdk",label:"JS SDK",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="Example SDK usage"',children:'// Get cat with ID 34\nconst cat = await manifest.from(\'cats\').findOneById(34)\n\nconsole.log(cat);\n// Output: {\n//  name: "Mina",\n//  description: "A really cute cat"\n// }\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"create-a-new-item",children:"Create a new item"}),"\n",(0,i.jsx)(n.p,{children:"This operation will create a new item and store it in the database. The newly created item is returned as response."}),"\n",(0,i.jsxs)(a.A,{children:[(0,i.jsxs)(r.A,{value:"rest",label:"REST API",default:!0,children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request URL"}),": ",(0,i.jsx)(n.code,{children:"POST /api/collections/:slug"})]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",metastring:'title="Example HTTP Request"',children:'POST /api/collections/pokemons\nContent-Type: application/json\nBody:\n{\n  "name": "Pikachu",\n  "type": "electric",\n  "level": 3,\n}\n\n'})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="Example HTTP Response"',children:'{\n  "id": 25,\n  "name": "Pikachu",\n  "type": "electric",\n  "level": 3,\n}\n'})})]}),(0,i.jsx)(r.A,{value:"sdk",label:"JS SDK",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="Example SDK usage"',children:'// Create a new item in the "pokemons" entity.\nconst newPokemon = await manifest.from(\'pokemons\').create({\n  name: "Pikachu",\n  type: "electric",\n  level: 3,\n})\n\nconsole.log(newPokemon);\n// Output: {\n//  id: 25,\n//  name: "Pikachu",\n//  type: "electric",\n//  level: 3\n// }\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"update-an-item",children:"Update an item"}),"\n",(0,i.jsx)(n.p,{children:"This operation will replace an existing item by the payload provided in the request and returns the updated item."}),"\n",(0,i.jsxs)(n.p,{children:["Unlike ",(0,i.jsx)(n.a,{href:"#patch-an-item",children:"partial updates"}),", this operation will replace the whole item by the new one. Missing or empty properties will delete the previous ones."]}),"\n",(0,i.jsxs)(a.A,{children:[(0,i.jsxs)(r.A,{value:"rest",label:"REST API",default:!0,children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request URL"}),": ",(0,i.jsx)(n.code,{children:"PUT /api/collections/:slug/:id"})]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",metastring:'title="Example HTTP Request"',children:'PUT /api/collections/pokemons/25\nContent-Type: application/json\nBody:\n{\n  "name": "Raichu",\n  "type": "electric",\n  "level": 8\n}\n\n'})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="Example HTTP Response"',children:'{\n  "id": 25,\n  "name": "Raichu",\n  "type": "electric",\n  "level": 8\n}\n'})})]}),(0,i.jsx)(r.A,{value:"sdk",label:"JS SDK",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="Example SDK usage"',children:'// Updates the Pokemon item with ID 25.\nconst newPokemon = await manifest.from(\'pokemons\').update(25, {\n  name: "Raichu",\n  type: "electric",\n  level: 8,\n})\n\nconsole.log(newPokemon);\n// Output: {\n//  id: 25,\n//  name: "Raichu",\n//  type: "electric",\n// level: 8\n// }\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"patch-an-item",children:"Patch an item"}),"\n",(0,i.jsx)(n.p,{children:"This operation will partially replace an existing item and return the updated item."}),"\n",(0,i.jsxs)(n.p,{children:["Unlike ",(0,i.jsx)(n.a,{href:"#update-an-item",children:"fully replacement"}),", this operation will only modify the properties provided in the payload and leave the other ones as they are."]}),"\n",(0,i.jsxs)(a.A,{children:[(0,i.jsxs)(r.A,{value:"rest",label:"REST API",default:!0,children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request URL"}),": ",(0,i.jsx)(n.code,{children:"PATCH /api/collections/:slug/:id"})]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",metastring:'title="Example HTTP Request"',children:'PATCH /api/collections/pokemons/25\nContent-Type: application/json\nBody:\n{\n  "level": 5,\n}\n'})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="Example HTTP Response"',children:'{\n  "id": 25,\n  "name": "Pikachu",\n  "type": "electric",\n  "level": 5\n}\n'})})]}),(0,i.jsx)(r.A,{value:"sdk",label:"JS SDK",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="Example SDK usage"',children:'// Patches the Pokemon item with ID 25.\nconst newPokemon = await manifest.from(\'pokemons\').patch(25, {\n  level: 5\n})\n\nconsole.log(newPokemon);\n// Output: {\n//  id: 25,\n//  name: "Pikachu",\n//  type: "electric",\n//  level: 5\n}\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"delete-an-item",children:"Delete an item"}),"\n",(0,i.jsx)(n.p,{children:"This operation will delete permanently an item from the database. This is an irreversible action. The deleted item is returned in the response."}),"\n",(0,i.jsxs)(a.A,{children:[(0,i.jsxs)(r.A,{value:"rest",label:"REST API",default:!0,children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request URL"}),": ",(0,i.jsx)(n.code,{children:"DELETE /api/collections/:slug/:id"})]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",metastring:'title="Example HTTP Request"',children:"DELETE api/collections/cats/60\n"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="Example HTTP Response"',children:'{\n  "name": "Fido",\n  "description": "A cute black cat"\n}\n'})})]}),(0,i.jsx)(r.A,{value:"sdk",label:"JS SDK",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="Example SDK usage"',children:' // Delete the cat with ID 60.\n const deletedCat = await manifest.from(\'cats\').delete(60)\n\n console.log(deletedCat);\n // Output: {\n //  name: "Fido",\n // description: "A cute black cat"\n // }\n'})})})]}),"\n",(0,i.jsx)(n.h2,{id:"singles",children:"Singles"}),"\n",(0,i.jsxs)(n.p,{children:["The following operations can be done on ",(0,i.jsx)(n.a,{href:"/docs/entities#singles",children:"singles"})," entities. As there is only a single item per entity, there is no list-related operations, and single items cannot be deleted as we always want to return an object, even if empty."]}),"\n",(0,i.jsx)(n.h3,{id:"get-a-single-item-1",children:"Get a single item"}),"\n",(0,i.jsxs)(a.A,{children:[(0,i.jsxs)(r.A,{value:"rest",label:"REST API",default:!0,children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request URL"}),": ",(0,i.jsx)(n.code,{children:"GET /api/singles/:slug"})]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",metastring:'title="Example HTTP Request"',children:"GET /api/singles/homepage\n"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="Example HTTP Response"',children:'{\n  "title": "My title",\n  "description": "Welcome to my website!"\n}\n'})})]}),(0,i.jsx)(r.A,{value:"sdk",label:"JS SDK",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="Example SDK usage"',children:' // Get the homepage entity.\n const homepage = await manifest.single(\'homepage\').get()\n\n console.log(homepage);\n // Output: {\n //  title: "My title",\n //  description: "Welcome to my website!"\n // }\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"update-an-item-1",children:"Update an item"}),"\n",(0,i.jsxs)(n.p,{children:["This operation will replace an existing item by the payload provided in the request. Unlike ",(0,i.jsx)(n.a,{href:"#patch-an-item-1",children:"partial updates"}),", this operation will replace the whole item by the new one. Missing or empty properties will delete the previous ones."]}),"\n",(0,i.jsxs)(a.A,{children:[(0,i.jsxs)(r.A,{value:"rest",label:"REST API",default:!0,children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request URL"}),": ",(0,i.jsx)(n.code,{children:"PUT /api/singles/:slug"})]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",metastring:'title="Example HTTP Request"',children:'PUT /api/singles/homepage\nContent-Type: application/json\nBody:\n{\n  "title": "My new title",\n  "description": "My new description"\n}\n\n'})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="Example HTTP Response"',children:'{\n  "title": "My new title",\n  "description": "My new description"\n}\n'})})]}),(0,i.jsx)(r.A,{value:"sdk",label:"JS SDK",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="Example SDK usage"',children:"// Update single entity.\nconst newHomepage = await manifest.single('homepage').update({\n    title: 'My new title',\n    description: 'My new description'\n})\n\n console.log(newHomepage);\n // Output: {\n //  title: \"My new title\",\n //  description: \"My new description\"\n // }\n"})})})]}),"\n",(0,i.jsx)(n.h3,{id:"patch-an-item-1",children:"Patch an item"}),"\n",(0,i.jsxs)(n.p,{children:["This operation will partially replace an existing item. Unlike ",(0,i.jsx)(n.a,{href:"#update-an-item-1",children:"fully replacement"}),", this operation will only modify the properties provided in the payload an leave the other ones as they are."]}),"\n",(0,i.jsxs)(a.A,{children:[(0,i.jsxs)(r.A,{value:"rest",label:"REST API",default:!0,children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request URL"}),": ",(0,i.jsx)(n.code,{children:"PATCH /api/singles/:slug"})]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",metastring:'title="Example HTTP Request"',children:'PATCH /api/singles/homepage\nContent-Type: application/json\nBody:\n{\n  "title": "My new title",\n}\n'})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="Example HTTP Response"',children:'{\n  "title": "My new title",\n  "description": "Welcome to my website!"\n}\n'})})]}),(0,i.jsx)(r.A,{value:"sdk",label:"JS SDK",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="Example SDK usage"',children:"// Update single entity partially.\nconst homepage = await manifest.single('homepage').patch({\n  title: 'My new title'\n})\nconsole.log(homepage)\n// Output: {\n//  title: \"My new title\",\n//  description: \"Welcome to my website!\"\n// }\n"})})})]}),"\n",(0,i.jsx)(n.h2,{id:"work-with-relations",children:"Work with relations"}),"\n",(0,i.jsxs)(n.p,{children:["If you added ",(0,i.jsx)(n.a,{href:"/docs/entities#relations",children:"relationships"})," between your entities, you probably want to include them in the CRUD operations."]}),"\n",(0,i.jsx)(n.h3,{id:"load-relations",children:"Load relations"}),"\n",(0,i.jsxs)(n.p,{children:["You can specify which relations you want to load with your entities in your query. ",(0,i.jsx)(n.strong,{children:"Eager relations"})," are loaded automatically."]}),"\n",(0,i.jsxs)(a.A,{children:[(0,i.jsx)(r.A,{value:"sdk",label:"JS SDK",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"  // Fetch entities with 2 relations.\n  const cities = await manifest\n    .from('cities')\n    .with(['region', 'mayor'])\n    .find()\n\n  // Fetch nested relations.\n  const cities = await manifest\n    .from('cities')\n    .with(['region', 'region.country', 'region.country.planet'])\n    .find()\n"})})}),(0,i.jsx)(r.A,{value:"rest",label:"REST API",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",children:"\n// Fetch entities with 2 relations.\nGET http://localhost:1111/api/dynamic/city?relations=region,mayor\n\n// Fetch nested relations.\nGET http://localhost:111/api/dynamic/city?relations=region,region.country,region.country.planet\n"})})})]}),"\n",(0,i.jsx)(n.h3,{id:"filter-by-relation",children:"Filter by relation"}),"\n",(0,i.jsx)(n.p,{children:"Once the relation is loaded, you can also filter items by their relation id or properties."}),"\n",(0,i.jsxs)(a.A,{children:[(0,i.jsx)(r.A,{value:"sdk",label:"JS SDK",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"  // Get all cats that belong to owner with id 1.\n  const cats = await manifest\n    .from('cats')\n    .with(['owner'])\n    .where('owner.id = 1')\n    .find()\n\n  // Get all cats that have an owner with name \"Jorge\".\n  const cats = await manifest\n    .from('cats')\n    .with(['owner'])\n    .where('owner.name = Jorge')\n    .find()\n"})})}),(0,i.jsx)(r.A,{value:"rest",label:"REST API",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",children:'// Get all cats that belong to owner with id 1.\nGET http://localhost:1111/api/dynamic/cats?relations=owner&owner.id_eq=1\n\n// Get all cats that have an owner with name "Jorge".\nGET http://localhost:1111/api/dynamic/cats?relations=owner&owner.name_eq=Jorge\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"store-relations",children:"Store relations"}),"\n",(0,i.jsxs)(n.p,{children:["To store or update an item with its relations, you have to pass the relation id(s) as a property that end with ",(0,i.jsx)(n.strong,{children:"Id"})," for many-to-one and ",(0,i.jsx)(n.strong,{children:"Ids"})," for many-to-many like ",(0,i.jsx)(n.code,{children:"companyId"})," or ",(0,i.jsx)(n.code,{children:"tagIds"})]}),"\n",(0,i.jsxs)(a.A,{children:[(0,i.jsx)(r.A,{value:"rest",label:"REST API",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",children:'// Store a new player with relations Team and Skill.\nPOST http://localhost:1111/api/dynamic/players\nContent-Type: application/json\n{\n    "name": "Mike",\n    "teamId": 10,\n    "skillIds": [1,2,3,4,5]\n}\n'})})}),(0,i.jsx)(r.A,{value:"sdk",label:"JS SDK",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"  // Store a new player with relations Team and Skill.\n  const newPlayer = await manifest.from('players').create({\n    name: 'Mike',\n    teamId: 10,\n    skillIds: [1,2,3,4,5]\n  })\n"})})})]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["When storing ",(0,i.jsx)(n.strong,{children:"many-to-many"})," relations, you always need to ",(0,i.jsx)(n.strong,{children:"pass an array"}),", even if you just have one single value."]})}),"\n",(0,i.jsx)(n.h3,{id:"update-relations",children:"Update relations"}),"\n",(0,i.jsxs)(n.p,{children:["As for updating properties, you can either do a ",(0,i.jsx)(n.strong,{children:"full replacement"})," using the update function (PUT) or a ",(0,i.jsx)(n.strong,{children:"partial replacement"})," using the patch function (PATCH)."]}),"\n",(0,i.jsxs)(a.A,{children:[(0,i.jsx)(r.A,{value:"rest",label:"REST API",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",children:"// Replaces the whole skill relations by the new skillIds array.\nPUT http://localhost:1111/api/dynamic/players/1\nContent-Type: application/json\n{\n  name: 'Mike',\n  teamId: 10,\n  skillIds: [10, 11]\n}\n\n// Updates the team without changing the skills or the name.\nPATCH http://localhost:1111/api/dynamic/players/1\nContent-Type: application/json\n{\n  teamId: 5,\n}\n"})})}),(0,i.jsx)(r.A,{value:"sdk",label:"JS SDK",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"  // Replaces the whole skill relations by the new skillIds array.\n  await manifest.from('players').update(1, {\n    name: 'Mike',\n    teamId: 10,\n    skillIds: [10, 11]\n  })\n\n  // Updates the team without changing the skills or the name.\n  await manifest.from('players').patch(1, {teamId: 5})\n"})})})]})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}},9329:(e,n,t)=>{t.d(n,{A:()=>a});t(6540);var s=t(4164);const i={tabItem:"tabItem_Ymn6"};var l=t(4848);function a(e){let{children:n,hidden:t,className:a}=e;return(0,l.jsx)("div",{role:"tabpanel",className:(0,s.A)(i.tabItem,a),hidden:t,children:n})}},5537:(e,n,t)=>{t.d(n,{A:()=>v});var s=t(6540),i=t(4164),l=t(5627),a=t(6347),r=t(372),c=t(604),d=t(1861),o=t(8749);function h(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,s.useMemo)((()=>{const e=n??function(e){return h(e).map((e=>{let{props:{value:n,label:t,attributes:s,default:i}}=e;return{value:n,label:t,attributes:s,default:i}}))}(t);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function u(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function x(e){let{queryString:n=!1,groupId:t}=e;const i=(0,a.W6)(),l=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,c.aZ)(l),(0,s.useCallback)((e=>{if(!l)return;const n=new URLSearchParams(i.location.search);n.set(l,e),i.replace({...i.location,search:n.toString()})}),[l,i])]}function j(e){const{defaultValue:n,queryString:t=!1,groupId:i}=e,l=p(e),[a,c]=(0,s.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!u({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const s=t.find((e=>e.default))??t[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:l}))),[d,h]=x({queryString:t,groupId:i}),[j,m]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[i,l]=(0,o.Dv)(t);return[i,(0,s.useCallback)((e=>{t&&l.set(e)}),[t,l])]}({groupId:i}),g=(()=>{const e=d??j;return u({value:e,tabValues:l})?e:null})();(0,r.A)((()=>{g&&c(g)}),[g]);return{selectedValue:a,selectValue:(0,s.useCallback)((e=>{if(!u({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);c(e),h(e),m(e)}),[h,m,l]),tabValues:l}}var m=t(9136);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=t(4848);function y(e){let{className:n,block:t,selectedValue:s,selectValue:a,tabValues:r}=e;const c=[],{blockElementScrollPositionUntilNextRender:d}=(0,l.a_)(),o=e=>{const n=e.currentTarget,t=c.indexOf(n),i=r[t].value;i!==s&&(d(n),a(i))},h=e=>{let n=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const t=c.indexOf(e.currentTarget)+1;n=c[t]??c[0];break}case"ArrowLeft":{const t=c.indexOf(e.currentTarget)-1;n=c[t]??c[c.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":t},n),children:r.map((e=>{let{value:n,label:t,attributes:l}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:s===n?0:-1,"aria-selected":s===n,ref:e=>{c.push(e)},onKeyDown:h,onClick:o,...l,className:(0,i.A)("tabs__item",g.tabItem,l?.className,{"tabs__item--active":s===n}),children:t??n},n)}))})}function w(e){let{lazy:n,children:t,selectedValue:l}=e;const a=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=a.find((e=>e.props.value===l));return e?(0,s.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:a.map(((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==l})))})}function b(e){const n=j(e);return(0,f.jsxs)("div",{className:(0,i.A)("tabs-container",g.tabList),children:[(0,f.jsx)(y,{...n,...e}),(0,f.jsx)(w,{...n,...e})]})}function v(e){const n=(0,m.A)();return(0,f.jsx)(b,{...e,children:h(e.children)},String(n))}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var s=t(6540);const i={},l=s.createContext(i);function a(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);