<!-- App Bar (displayed above any widget when configured) -->
@if (config.appBar) {
<div
  class="widget-container__app-bar"
  [class.widget-container__app-bar--sales]="config.appBar.logo === 'sales'"
  [class.widget-container__app-bar--skyscanner]="config.appBar.logo === 'skyscanner'"
  [class.widget-container__app-bar--marketing]="config.appBar.logo === 'marketing'"
  [class.widget-container__app-bar--devops]="config.appBar.logo === 'devops'"
>
  <div class="widget-container__app-bar-left">
    <div
      class="widget-container__app-logo"
      [class.widget-container__app-logo--sales]="config.appBar.logo === 'sales'"
      [class.widget-container__app-logo--skyscanner]="config.appBar.logo === 'skyscanner'"
      [class.widget-container__app-logo--marketing]="config.appBar.logo === 'marketing'"
      [class.widget-container__app-logo--devops]="config.appBar.logo === 'devops'"
    >
      @if (config.appBar.logo === 'devops') {
      <!-- SafeStack logo -->
      <svg width="16" height="10" viewBox="0 0 62 40" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M32 10H42C47.5228 10 52 14.4772 52 20C52 25.5228 47.5228 30 42 30H36V28H42C46.4183 28 50 24.4183 50 20C50 15.5817 46.4183 12 42 12H32V22H42C43.1046 22 44 21.1046 44 20C44 18.8954 43.1046 18 42 18H36V16H42C44.2091 16 46 17.7909 46 20C46 22.2091 44.2091 24 42 24H32V34H42C49.732 34 56 27.732 56 20C56 12.268 49.732 6 42 6H36V4H42C50.8366 4 58 11.1634 58 20C58 28.8366 50.8366 36 42 36H32V40H42C53.0457 40 62 31.0457 62 20C62 8.95431 53.0457 0 42 0H32V10Z" fill="#4D0DA2"/>
        <path d="M20 0C8.95431 0 0 8.95431 0 20C0 31.0457 8.95431 40 20 40H30V30H20C14.4772 30 10 25.5228 10 20C10 14.4772 14.4772 10 20 10H26V12H20C15.5817 12 12 15.5817 12 20C12 24.4183 15.5817 28 20 28H30V18H20C18.8954 18 18 18.8954 18 20C18 21.1046 18.8954 22 20 22H26V24H20C17.7909 24 16 22.2091 16 20C16 17.7909 17.7909 16 20 16H30V6H20C12.268 6 6 12.268 6 20C6 27.732 12.268 34 20 34H26V36H20C11.1634 36 4 28.8366 4 20C4 11.1634 11.1634 4 20 4H30V0H20Z" fill="#4D0DA2"/>
      </svg>
      } @else if (config.appBar.logo === 'marketing') {
      <!-- DataSync Logo (chart/bars icon) -->
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 13h4v8H3v-8zm7-10h4v18h-4V3zm7 6h4v12h-4V9z"/>
      </svg>
      } @else if (config.appBar.logo === 'sales') {
      <svg width="16" height="16" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M20 0C25.3043 4.00466e-07 30.3919 2.10669 34.1426 5.85742C34.8157 6.53058 35.4354 7.24719 36 8H20C16.8174 8 13.7651 9.26421 11.5146 11.5146C9.26421 13.7651 8 16.8174 8 20H20L36.9102 9.31934C38.1656 11.3074 39.0611 13.5027 39.5547 15.8027L32 20H40L39.9941 20.4971C39.8669 25.6213 37.776 30.5092 34.1426 34.1426C30.3919 37.8933 25.3043 40 20 40C14.6957 40 9.60815 37.8933 5.85742 34.1426C5.18426 33.4694 4.56459 32.7528 4 32H20C23.1826 32 26.2349 30.7358 28.4854 28.4854C30.5952 26.3755 31.8383 23.5608 31.9854 20.5947L32 20H20L3.08984 30.6787C1.83452 28.6906 0.941002 26.4951 0.447266 24.1953L8 20H0C8.00931e-07 14.6957 2.1067 9.60815 5.85742 5.85742C9.60815 2.1067 14.6957 -5.79361e-10 20 0Z" fill="currentColor"/>
      </svg>
      } @else if (config.appBar.logo === 'skyscanner') {
      <!-- Skyscanner Logo -->
      <svg width="18" height="12" viewBox="0 0 78 49" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M38.7365 48.8699C39.5497 48.8699 40.3242 48.6762 41.0599 48.2503L49.5405 43.371C51.2444 42.4029 53.2193 41.977 55.1942 42.2093C65.4949 43.4098 72.6975 45.346 74.8274 45.9656C75.2533 46.0817 75.7567 45.9268 76.0278 45.5783C76.3763 45.1523 76.8023 44.4553 77.1508 43.4485C77.4606 42.4804 77.4993 41.6672 77.4606 41.0863C77.4219 40.6216 77.1121 40.1957 76.6474 40.0795C73.3171 39.1114 58.5632 35.1228 38.7365 35.1228C18.9098 35.1228 4.15587 39.1114 0.825597 40.0795C0.360908 40.1957 0.0511157 40.6216 0.0123916 41.0863C-0.0263325 41.6285 0.0123928 42.4417 0.322186 43.4485C0.631978 44.4553 1.09667 45.1523 1.44519 45.5783C1.71625 45.9268 2.21967 46.0817 2.64563 45.9656C4.77546 45.346 12.0169 43.4098 22.2788 42.2093C24.2537 41.977 26.2286 42.4029 27.9325 43.371L36.4131 48.2503C37.1488 48.6762 37.962 48.8699 38.7365 48.8699Z" fill="currentColor"/>
        <path d="M24.6022 21.4145C25.0669 22.2277 25.8026 22.7699 26.6545 23.0022C27.5065 23.2345 28.3971 23.1184 29.2103 22.6537C30.0235 22.189 30.5657 21.4532 30.798 20.6013C31.0304 19.7494 30.9142 18.8587 30.4495 18.0455L22.8209 4.8406C22.5885 4.41463 22.0851 4.25973 21.6204 4.29846C21.0008 4.33718 20.1489 4.64698 19.1421 5.22784C18.1352 5.8087 17.4382 6.38956 17.0897 6.89297C16.8186 7.28021 16.7412 7.78363 16.9735 8.20959L24.6022 21.4145Z" fill="currentColor"/>
        <path d="M17.6318 30.8631C18.445 31.3278 19.3744 31.4052 20.1876 31.2116C21.0395 30.9792 21.7753 30.4371 22.24 29.6239C22.7047 28.8107 22.7821 27.8813 22.5885 27.0681C22.3949 26.2549 21.814 25.4804 21.0008 25.0157L7.79588 17.3871C7.36991 17.1547 6.8665 17.2322 6.47926 17.5033C5.97585 17.8518 5.39499 18.5488 4.81413 19.5556C4.23326 20.5625 3.92347 21.4144 3.88475 22.034C3.84602 22.5374 4.03964 23.0021 4.42688 23.2344L17.6318 30.8631Z" fill="currentColor"/>
        <path d="M42.1052 16.7288C42.1052 17.6582 41.7179 18.5101 41.1371 19.1297C40.5175 19.7493 39.7043 20.0978 38.7362 20.0978C37.8068 20.0978 36.9549 19.7106 36.3353 19.1297C35.7157 18.5101 35.3672 17.6969 35.3672 16.7288V1.51024C35.3672 1.00682 35.677 0.619585 36.1417 0.425965C36.6838 0.154896 37.5745 0 38.7362 0C39.8979 0 40.7886 0.154896 41.3307 0.425965C41.7567 0.658309 42.1052 1.00682 42.1052 1.51024V16.7288Z" fill="currentColor"/>
        <path d="M52.8706 21.4145C52.4059 22.2277 51.6702 22.7699 50.8182 23.0022C49.9663 23.2345 49.0757 23.1184 48.2625 22.6537C47.4492 22.189 46.9071 21.4532 46.6748 20.6013C46.4424 19.7494 46.5586 18.8587 47.0233 18.0455L54.6519 4.8406C54.8843 4.41463 55.3877 4.25973 55.8524 4.29846C56.472 4.33718 57.3239 4.64698 58.3307 5.22784C59.3375 5.8087 60.0346 6.38956 60.3831 6.89297C60.6542 7.28021 60.7316 7.78363 60.4993 8.20959L52.8706 21.4145Z" fill="currentColor"/>
        <path d="M59.8408 30.8631C59.0276 31.3278 58.0982 31.4052 57.285 31.2116C56.4331 30.9792 55.6973 30.4371 55.2326 29.6239C54.7679 28.8107 54.6905 27.8813 54.8841 27.0681C55.1165 26.2162 55.6586 25.4804 56.4718 25.0157L69.6767 17.3871C70.1027 17.1547 70.6061 17.2322 70.9933 17.5033C71.4968 17.8518 72.0776 18.5488 72.6585 19.5556C73.2394 20.5625 73.5491 21.4144 73.5879 22.034C73.6266 22.5374 73.433 23.0021 73.0457 23.2344L59.8408 30.8631Z" fill="currentColor"/>
      </svg>
      } @else {
      <svg
        width="14"
        height="10"
        viewBox="0 0 58 40"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M24.6625 0C29.5499 0.000157557 33.512 3.87456 33.5121 8.65224C33.5121 8.91866 33.4997 9.18398 33.4824 9.44828H40.9366C48.1871 9.44828 51.0342 18.6407 45.0014 22.5723L37.1131 27.7122C35.415 28.8193 35.8805 31.3743 37.8654 31.84C38.5143 31.9921 39.1997 31.8658 39.7475 31.4934L44.3242 28.1927C44.4979 28.0675 44.7074 28 44.9225 28H57.4922C57.9872 28 58.1886 28.6281 57.7838 28.909L44.4783 38.1397C41.99 39.8319 38.8796 40.4048 35.9321 39.7133C26.9186 37.5986 24.8061 26.0015 32.5185 20.9749L37.7818 17.5457H29.7048H24.5358C23.0515 17.5457 21.6504 17.1926 20.4171 16.5691C21.7314 17.4535 24.9805 18.4377 27.7216 18.6251C27.9658 18.6251 28.3625 18.8385 27.8901 19.3183L11.2952 35.7067C11.105 35.8945 10.847 36 10.578 36H0.507884C0.056246 36 -0.169872 35.4613 0.149574 35.1463L19.5219 16.0472C17.1349 14.4709 15.5652 11.8013 15.5649 8.77349C15.5649 3.92875 19.5825 0 24.5385 0H24.6625ZM24.8419 6.74915C23.6982 6.74915 22.771 7.35337 22.771 8.09871C22.7715 8.71319 23.4024 9.23009 24.2648 9.39292C24.3487 9.42847 24.4413 9.44828 24.5385 9.44828H25.1533C25.1544 9.44225 25.1535 9.43586 25.1546 9.42983C26.1495 9.33152 26.9122 8.77441 26.9127 8.09871C26.9127 7.35337 25.9855 6.74915 24.8419 6.74915Z"
          fill="currentColor"
        />
      </svg>
      }
    </div>
    <span class="widget-container__app-bar-name">{{ config.appBar.name }}</span>
  </div>
  <div class="widget-container__app-bar-right">
    <button class="widget-container__feedback-btn">
      <svg
        width="14"
        height="14"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path
          d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"
        />
      </svg>
    </button>
    <button class="widget-container__feedback-btn">
      <svg
        width="14"
        height="14"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path
          d="M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"
        />
      </svg>
    </button>
  </div>
</div>
}

@if (config.style === 'marketing') {
<!-- Marketing-style widget (LIGHT THEME with orange accents) -->
<div class="widget-container widget-container--marketing">
  <!-- Marketing header -->
  <div class="widget-container__marketing-header">
    <div class="widget-container__marketing-header-left">
      @if (config.header?.title) {
      <h3 class="widget-container__marketing-title">{{ config.header.title }}</h3>
      }
      @if (config.header?.subtitle) {
      <span class="widget-container__marketing-subtitle">{{ config.header.subtitle }}</span>
      }
    </div>
  </div>

  <!-- Marketing body -->
  <div class="widget-container__marketing-body">
    <ng-container *ngTemplateOutlet="widgetSectionsMarketing"></ng-container>
  </div>
</div>
} @else if (config.style === 'skyscanner') {
<!-- Skyscanner-style widget (LIGHT THEME) -->
<div class="widget-container widget-container--skyscanner">
  <!-- Skyscanner header -->
  <div class="widget-container__skyscanner-header">
    <div class="widget-container__skyscanner-header-left">
      @if (config.header?.title) {
      <h3 class="widget-container__skyscanner-title">{{ config.header.title }}</h3>
      }
      @if (config.header?.subtitle) {
      <span class="widget-container__skyscanner-subtitle">{{ config.header.subtitle }}</span>
      }
    </div>
  </div>

  <!-- Skyscanner body -->
  <div class="widget-container__skyscanner-body">
    <ng-container *ngTemplateOutlet="widgetSectionsSkyscanner"></ng-container>
  </div>
</div>
} @else if (config.style === 'sales') {
<!-- Sales-style widget (LIGHT THEME) -->
<div class="widget-container widget-container--sales">
  <!-- Sales header -->
  <div class="widget-container__sales-header">
    <div class="widget-container__sales-header-left">
      @if (config.header?.title) {
      <h3 class="widget-container__sales-title">{{ config.header.title }}</h3>
      }
      @if (config.header?.subtitle) {
      <span class="widget-container__sales-subtitle">{{ config.header.subtitle }}</span>
      }
    </div>
    <div class="widget-container__sales-header-right">
      @if (config.header?.badge) {
      <div class="widget-container__sales-badge" [class.widget-container__sales-badge--live]="config.header.badge.type === 'live'">
        <span class="widget-container__sales-badge-dot"></span>
        <span>{{ config.header.badge.label }}</span>
      </div>
      }
    </div>
  </div>

  <!-- Sales body -->
  <div class="widget-container__sales-body">
    <ng-container *ngTemplateOutlet="widgetSectionsSales"></ng-container>
  </div>
</div>
} @else if (config.style === 'devops') {
<!-- DevOps-style widget (LIGHT THEME - Bugsnag-like) -->
<div class="widget-container widget-container--devops">
  <!-- DevOps header -->
  <div class="widget-container__devops-header">
    <div class="widget-container__devops-header-left">
      @if (config.header?.title) {
      <h3 class="widget-container__devops-title">{{ config.header.title }}</h3>
      }
      @if (config.header?.subtitle) {
      <span class="widget-container__devops-subtitle">{{ config.header.subtitle }}</span>
      }
    </div>
    <div class="widget-container__devops-header-right">
      @if (config.header?.badge) {
      <div class="widget-container__devops-badge" [class.widget-container__devops-badge--live]="config.header.badge.type === 'live'">
        <span class="widget-container__devops-badge-dot"></span>
        <span>{{ config.header.badge.label }}</span>
      </div>
      }
    </div>
  </div>

  <!-- DevOps body -->
  <div class="widget-container__devops-body">
    <ng-container *ngTemplateOutlet="widgetSectionsDevops"></ng-container>
  </div>
</div>
} @else if (config.style === 'browser') {
<!-- Browser-style widget -->
<div class="widget-container widget-container--browser">
  <div class="widget-container__content">
    @if (config.header?.title || config.header?.badge) {
    <div class="widget-container__app-header">
      <div class="widget-container__app-title">
        @if (config.header?.icon) {
        <div class="widget-container__app-icon">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2L2 7l10 5 10-5-10-5z" />
            <path d="M2 17l10 5 10-5" />
            <path d="M2 12l10 5 10-5" />
          </svg>
        </div>
        }
        @if (config.header?.title) {
        <h3 class="widget-container__app-name">{{ config.header.title }}</h3>
        }
      </div>
      @if (config.header?.badge) {
      <div class="widget-container__app-badge">
        <span class="widget-container__app-badge-dot"></span>
        <span>{{ config.header.badge.label }}</span>
      </div>
      }
    </div>
    }
    <div class="widget-container__body">
      <ng-container *ngTemplateOutlet="widgetSections"></ng-container>
    </div>
  </div>
</div>
} @else {
<!-- HRIS-style widget (DARK THEME) -->
<div class="widget-container widget-container--hris">
  @if (config.header?.badge) {
  <div class="widget-container__hris-header">
    <div class="widget-container__hris-badge">
      <span class="widget-container__hris-badge-dot"></span>
      <span>{{ config.header.badge.label }}</span>
    </div>
  </div>
  }
  <div class="widget-container__hris-body">
    @if (config.header?.title) {
    <div class="widget-container__title-row">
      <h3 class="widget-container__title">{{ config.header.title }}</h3>
      @if (config.header?.subtitle) {
      <span class="widget-container__period">{{ config.header.subtitle }}</span>
      }
    </div>
    }
    <ng-container *ngTemplateOutlet="widgetSections"></ng-container>
  </div>
</div>
}

<!-- Widget Sections Template (Dark theme) -->
<ng-template #widgetSections>
  @for (section of config.sections; track $index) {
    @switch (section.type) {
      @case ('stat-grid') {
        <app-stat-grid-widget [data]="asStatGrid(section)"></app-stat-grid-widget>
      }
      @case ('bar-chart') {
        <app-bar-chart-widget [data]="asBarChart(section)"></app-bar-chart-widget>
      }
      @case ('data-table') {
        <app-data-table-widget [data]="asDataTable(section)"></app-data-table-widget>
      }
      @case ('data-grid') {
        <app-data-grid-widget [data]="asDataGrid(section)"></app-data-grid-widget>
      }
      @case ('action-buttons') {
        <app-action-buttons-widget [data]="asActionButtons(section)" [theme]="'dark'"></app-action-buttons-widget>
      }
      @case ('pipeline') {
        <app-pipeline-widget [data]="asPipeline(section)"></app-pipeline-widget>
      }
      @case ('deal-cards') {
        <app-deal-cards-widget [data]="asDealCards(section)"></app-deal-cards-widget>
      }
    }
  }
</ng-template>

<!-- Widget Sections Template (Light theme for Sales) -->
<ng-template #widgetSectionsSales>
  @for (section of config.sections; track $index) {
    @switch (section.type) {
      @case ('stat-grid') {
        <app-stat-grid-widget [data]="asStatGrid(section)" [theme]="'light'"></app-stat-grid-widget>
      }
      @case ('bar-chart') {
        <app-bar-chart-widget [data]="asBarChart(section)" [theme]="'light'"></app-bar-chart-widget>
      }
      @case ('data-table') {
        <app-data-table-widget [data]="asDataTable(section)" [theme]="'light'"></app-data-table-widget>
      }
      @case ('data-grid') {
        <app-data-grid-widget [data]="asDataGrid(section)" [theme]="'light'"></app-data-grid-widget>
      }
      @case ('action-buttons') {
        <app-action-buttons-widget [data]="asActionButtons(section)" [theme]="'light'"></app-action-buttons-widget>
      }
      @case ('pipeline') {
        <app-pipeline-widget [data]="asPipeline(section)" [theme]="'light'"></app-pipeline-widget>
      }
      @case ('deal-cards') {
        <app-deal-cards-widget [data]="asDealCards(section)" [theme]="'light'"></app-deal-cards-widget>
      }
      @case ('flight-cards') {
        <app-flight-cards-widget [data]="asFlightCards(section)" [theme]="'light'"></app-flight-cards-widget>
      }
    }
  }
</ng-template>

<!-- Widget Sections Template (Skyscanner theme) -->
<ng-template #widgetSectionsSkyscanner>
  @for (section of config.sections; track $index) {
    @switch (section.type) {
      @case ('flight-cards') {
        <app-flight-cards-widget [data]="asFlightCards(section)" [theme]="'light'"></app-flight-cards-widget>
      }
      @case ('stat-grid') {
        <app-stat-grid-widget [data]="asStatGrid(section)" [theme]="'light'"></app-stat-grid-widget>
      }
      @case ('action-buttons') {
        <app-action-buttons-widget [data]="asActionButtons(section)" [theme]="'light'"></app-action-buttons-widget>
      }
    }
  }
</ng-template>

<!-- Widget Sections Template (Marketing theme) -->
<ng-template #widgetSectionsMarketing>
  @for (section of config.sections; track $index) {
    @switch (section.type) {
      @case ('bar-chart') {
        <app-bar-chart-widget [data]="asBarChart(section)" [theme]="'light'"></app-bar-chart-widget>
      }
      @case ('stat-grid') {
        <app-stat-grid-widget [data]="asStatGrid(section)" [theme]="'light'"></app-stat-grid-widget>
      }
      @case ('data-table') {
        <app-data-table-widget [data]="asDataTable(section)" [theme]="'light'"></app-data-table-widget>
      }
      @case ('action-buttons') {
        <app-action-buttons-widget [data]="asActionButtons(section)" [theme]="'light'"></app-action-buttons-widget>
      }
    }
  }
</ng-template>

<!-- Widget Sections Template (DevOps theme - Bugsnag-like) -->
<ng-template #widgetSectionsDevops>
  @for (section of config.sections; track $index) {
    @switch (section.type) {
      @case ('deployment-timeline') {
        <app-deployment-timeline-widget [data]="asDeploymentTimeline(section)" [theme]="'light'"></app-deployment-timeline-widget>
      }
      @case ('stat-grid') {
        <app-stat-grid-widget [data]="asStatGrid(section)" [theme]="'light'"></app-stat-grid-widget>
      }
      @case ('bar-chart') {
        <app-bar-chart-widget [data]="asBarChart(section)" [theme]="'light'"></app-bar-chart-widget>
      }
      @case ('data-table') {
        <app-data-table-widget [data]="asDataTable(section)" [theme]="'light'"></app-data-table-widget>
      }
      @case ('action-buttons') {
        <app-action-buttons-widget [data]="asActionButtons(section)" [theme]="'light'"></app-action-buttons-widget>
      }
    }
  }
</ng-template>
